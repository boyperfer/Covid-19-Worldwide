{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport * as MapboxGl from 'mapbox-gl';\nimport * as React from 'react';\nimport { listenEvents, events, updateEvents } from './map-events';\nimport { MapContext } from './context';\nimport { createPortal } from 'react-dom';\n\nvar isEqual = require('deep-equal');\n\nvar defaultZoom = [11];\nvar defaultMovingMethod = 'flyTo';\nvar defaultCenter = [-0.2416815, 51.5285582];\n\nvar ReactMapboxFactory = function (_a) {\n  var accessToken = _a.accessToken,\n      apiUrl = _a.apiUrl,\n      _b = _a.minZoom,\n      minZoom = _b === void 0 ? 0 : _b,\n      _c = _a.maxZoom,\n      maxZoom = _c === void 0 ? 20 : _c,\n      _d = _a.hash,\n      hash = _d === void 0 ? false : _d,\n      _e = _a.preserveDrawingBuffer,\n      preserveDrawingBuffer = _e === void 0 ? false : _e,\n      _f = _a.scrollZoom,\n      scrollZoom = _f === void 0 ? true : _f,\n      _g = _a.interactive,\n      interactive = _g === void 0 ? true : _g,\n      _h = _a.dragRotate,\n      dragRotate = _h === void 0 ? true : _h,\n      _j = _a.pitchWithRotate,\n      pitchWithRotate = _j === void 0 ? true : _j,\n      _k = _a.attributionControl,\n      attributionControl = _k === void 0 ? true : _k,\n      customAttribution = _a.customAttribution,\n      _l = _a.logoPosition,\n      logoPosition = _l === void 0 ? 'bottom-left' : _l,\n      _m = _a.renderWorldCopies,\n      renderWorldCopies = _m === void 0 ? true : _m,\n      _o = _a.trackResize,\n      trackResize = _o === void 0 ? true : _o,\n      _p = _a.touchZoomRotate,\n      touchZoomRotate = _p === void 0 ? true : _p,\n      _q = _a.doubleClickZoom,\n      doubleClickZoom = _q === void 0 ? true : _q,\n      _r = _a.keyboard,\n      keyboard = _r === void 0 ? true : _r,\n      _s = _a.dragPan,\n      dragPan = _s === void 0 ? true : _s,\n      _t = _a.boxZoom,\n      boxZoom = _t === void 0 ? true : _t,\n      _u = _a.refreshExpiredTiles,\n      refreshExpiredTiles = _u === void 0 ? true : _u,\n      _v = _a.failIfMajorPerformanceCaveat,\n      failIfMajorPerformanceCaveat = _v === void 0 ? false : _v,\n      _w = _a.bearingSnap,\n      bearingSnap = _w === void 0 ? 7 : _w,\n      _x = _a.injectCSS,\n      injectCSS = _x === void 0 ? true : _x,\n      _y = _a.antialias,\n      antialias = _y === void 0 ? false : _y,\n      transformRequest = _a.transformRequest;\n\n  var _z;\n\n  if (injectCSS) {\n    require('mapbox-gl/dist/mapbox-gl.css');\n  }\n\n  return _z = function (_super) {\n    __extends(ReactMapboxGl, _super);\n\n    function ReactMapboxGl() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n\n      _this.state = {\n        map: undefined,\n        ready: false\n      };\n      _this.listeners = {};\n      _this._isMounted = true;\n\n      _this.calcCenter = function (bounds) {\n        return [(bounds[0][0] + bounds[1][0]) / 2, (bounds[0][1] + bounds[1][1]) / 2];\n      };\n\n      _this.setRef = function (x) {\n        _this.container = x;\n      };\n\n      return _this;\n    }\n\n    ReactMapboxGl.prototype.componentDidMount = function () {\n      var _this = this;\n\n      var _a = this.props,\n          style = _a.style,\n          onStyleLoad = _a.onStyleLoad,\n          center = _a.center,\n          pitch = _a.pitch,\n          zoom = _a.zoom,\n          fitBounds = _a.fitBounds,\n          fitBoundsOptions = _a.fitBoundsOptions,\n          bearing = _a.bearing,\n          maxBounds = _a.maxBounds;\n      MapboxGl.accessToken = accessToken;\n\n      if (apiUrl) {\n        MapboxGl.config.API_URL = apiUrl;\n      }\n\n      if (!Array.isArray(zoom)) {\n        throw new Error('zoom need to be an array type of length 1 for reliable update');\n      }\n\n      var opts = {\n        preserveDrawingBuffer: preserveDrawingBuffer,\n        hash: hash,\n        zoom: zoom[0],\n        minZoom: minZoom,\n        maxZoom: maxZoom,\n        maxBounds: maxBounds,\n        container: this.container,\n        center: fitBounds && center === defaultCenter ? this.calcCenter(fitBounds) : center,\n        style: style,\n        scrollZoom: scrollZoom,\n        attributionControl: attributionControl,\n        customAttribution: customAttribution,\n        interactive: interactive,\n        dragRotate: dragRotate,\n        pitchWithRotate: pitchWithRotate,\n        renderWorldCopies: renderWorldCopies,\n        trackResize: trackResize,\n        touchZoomRotate: touchZoomRotate,\n        doubleClickZoom: doubleClickZoom,\n        keyboard: keyboard,\n        dragPan: dragPan,\n        boxZoom: boxZoom,\n        refreshExpiredTiles: refreshExpiredTiles,\n        logoPosition: logoPosition,\n        bearingSnap: bearingSnap,\n        failIfMajorPerformanceCaveat: failIfMajorPerformanceCaveat,\n        antialias: antialias,\n        transformRequest: transformRequest\n      };\n\n      if (bearing) {\n        if (!Array.isArray(bearing)) {\n          throw new Error('bearing need to be an array type of length 1 for reliable update');\n        }\n\n        opts.bearing = bearing[0];\n      }\n\n      if (pitch) {\n        if (!Array.isArray(pitch)) {\n          throw new Error('pitch need to be an array type of length 1 for reliable update');\n        }\n\n        opts.pitch = pitch[0];\n      }\n\n      var map = new MapboxGl.Map(opts);\n      this.setState({\n        map: map\n      });\n\n      if (fitBounds) {\n        map.fitBounds(fitBounds, fitBoundsOptions, {\n          fitboundUpdate: true\n        });\n      }\n\n      map.on('load', function (evt) {\n        if (_this._isMounted) {\n          _this.setState({\n            ready: true\n          });\n        }\n\n        if (onStyleLoad) {\n          onStyleLoad(map, evt);\n        }\n      });\n      this.listeners = listenEvents(events, this.props, map);\n    };\n\n    ReactMapboxGl.prototype.componentWillUnmount = function () {\n      var map = this.state.map;\n      this._isMounted = false;\n\n      if (map) {\n        map.remove();\n      }\n    };\n\n    ReactMapboxGl.prototype.UNSAFE_componentWillReceiveProps = function (nextProps) {\n      var map = this.state.map;\n\n      if (!map) {\n        return null;\n      }\n\n      this.listeners = updateEvents(this.listeners, nextProps, map);\n      var center = map.getCenter();\n      var zoom = map.getZoom();\n      var bearing = map.getBearing();\n      var pitch = map.getPitch();\n      var didZoomUpdate = this.props.zoom !== nextProps.zoom && (nextProps.zoom && nextProps.zoom[0]) !== zoom;\n      var didCenterUpdate = this.props.center !== nextProps.center && ((nextProps.center && nextProps.center[0]) !== center.lng || (nextProps.center && nextProps.center[1]) !== center.lat);\n      var didBearingUpdate = this.props.bearing !== nextProps.bearing && (nextProps.bearing && nextProps.bearing[0]) !== bearing;\n      var didPitchUpdate = this.props.pitch !== nextProps.pitch && (nextProps.pitch && nextProps.pitch[0]) !== pitch;\n\n      if (nextProps.maxBounds) {\n        var didMaxBoundsUpdate = this.props.maxBounds !== nextProps.maxBounds;\n\n        if (didMaxBoundsUpdate) {\n          map.setMaxBounds(nextProps.maxBounds);\n        }\n      }\n\n      if (nextProps.fitBounds) {\n        var fitBounds = this.props.fitBounds;\n        var didFitBoundsUpdate = fitBounds !== nextProps.fitBounds || nextProps.fitBounds.length !== (fitBounds && fitBounds.length) || !!fitBounds.filter(function (c, i) {\n          var nc = nextProps.fitBounds && nextProps.fitBounds[i];\n          return c[0] !== (nc && nc[0]) || c[1] !== (nc && nc[1]);\n        })[0];\n\n        if (didFitBoundsUpdate || !isEqual(this.props.fitBoundsOptions, nextProps.fitBoundsOptions)) {\n          map.fitBounds(nextProps.fitBounds, nextProps.fitBoundsOptions, {\n            fitboundUpdate: true\n          });\n        }\n      }\n\n      if (didZoomUpdate || didCenterUpdate || didBearingUpdate || didPitchUpdate) {\n        var mm = nextProps.movingMethod || defaultMovingMethod;\n        var flyToOptions = nextProps.flyToOptions,\n            animationOptions = nextProps.animationOptions;\n        map[mm](__assign({}, animationOptions, flyToOptions, {\n          zoom: didZoomUpdate && nextProps.zoom ? nextProps.zoom[0] : zoom,\n          center: didCenterUpdate ? nextProps.center : center,\n          bearing: didBearingUpdate ? nextProps.bearing : bearing,\n          pitch: didPitchUpdate ? nextProps.pitch : pitch\n        }));\n      }\n\n      if (!isEqual(this.props.style, nextProps.style)) {\n        map.setStyle(nextProps.style);\n      }\n\n      return null;\n    };\n\n    ReactMapboxGl.prototype.render = function () {\n      var _a = this.props,\n          containerStyle = _a.containerStyle,\n          className = _a.className,\n          children = _a.children,\n          renderChildrenInPortal = _a.renderChildrenInPortal;\n      var _b = this.state,\n          ready = _b.ready,\n          map = _b.map;\n\n      if (renderChildrenInPortal) {\n        var container = ready && map && typeof map.getCanvasContainer === 'function' ? map.getCanvasContainer() : undefined;\n        return React.createElement(MapContext.Provider, {\n          value: map\n        }, React.createElement(\"div\", {\n          ref: this.setRef,\n          className: className,\n          style: __assign({}, containerStyle)\n        }, ready && container && createPortal(children, container)));\n      }\n\n      return React.createElement(MapContext.Provider, {\n        value: map\n      }, React.createElement(\"div\", {\n        ref: this.setRef,\n        className: className,\n        style: __assign({}, containerStyle)\n      }, ready && children));\n    };\n\n    return ReactMapboxGl;\n  }(React.Component), _z.defaultProps = {\n    onStyleLoad: function (map, evt) {\n      return null;\n    },\n    center: defaultCenter,\n    zoom: defaultZoom,\n    bearing: 0,\n    movingMethod: defaultMovingMethod,\n    pitch: 0,\n    containerStyle: {\n      textAlign: 'left'\n    }\n  }, _z;\n};\n\nexport default ReactMapboxFactory;","map":{"version":3,"sources":["../src/map.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport * as MapboxGl from 'mapbox-gl';\nimport * as React from 'react';\nimport { listenEvents, events, updateEvents } from './map-events';\nimport { MapContext } from './context';\nimport { createPortal } from 'react-dom';\nvar isEqual = require('deep-equal');\nvar defaultZoom = [11];\nvar defaultMovingMethod = 'flyTo';\nvar defaultCenter = [-0.2416815, 51.5285582];\nvar ReactMapboxFactory = function (_a) {\n    var accessToken = _a.accessToken, apiUrl = _a.apiUrl, _b = _a.minZoom, minZoom = _b === void 0 ? 0 : _b, _c = _a.maxZoom, maxZoom = _c === void 0 ? 20 : _c, _d = _a.hash, hash = _d === void 0 ? false : _d, _e = _a.preserveDrawingBuffer, preserveDrawingBuffer = _e === void 0 ? false : _e, _f = _a.scrollZoom, scrollZoom = _f === void 0 ? true : _f, _g = _a.interactive, interactive = _g === void 0 ? true : _g, _h = _a.dragRotate, dragRotate = _h === void 0 ? true : _h, _j = _a.pitchWithRotate, pitchWithRotate = _j === void 0 ? true : _j, _k = _a.attributionControl, attributionControl = _k === void 0 ? true : _k, customAttribution = _a.customAttribution, _l = _a.logoPosition, logoPosition = _l === void 0 ? 'bottom-left' : _l, _m = _a.renderWorldCopies, renderWorldCopies = _m === void 0 ? true : _m, _o = _a.trackResize, trackResize = _o === void 0 ? true : _o, _p = _a.touchZoomRotate, touchZoomRotate = _p === void 0 ? true : _p, _q = _a.doubleClickZoom, doubleClickZoom = _q === void 0 ? true : _q, _r = _a.keyboard, keyboard = _r === void 0 ? true : _r, _s = _a.dragPan, dragPan = _s === void 0 ? true : _s, _t = _a.boxZoom, boxZoom = _t === void 0 ? true : _t, _u = _a.refreshExpiredTiles, refreshExpiredTiles = _u === void 0 ? true : _u, _v = _a.failIfMajorPerformanceCaveat, failIfMajorPerformanceCaveat = _v === void 0 ? false : _v, _w = _a.bearingSnap, bearingSnap = _w === void 0 ? 7 : _w, _x = _a.injectCSS, injectCSS = _x === void 0 ? true : _x, _y = _a.antialias, antialias = _y === void 0 ? false : _y, transformRequest = _a.transformRequest;\n    var _z;\n    if (injectCSS) {\n        require('mapbox-gl/dist/mapbox-gl.css');\n    }\n    return _z = (function (_super) {\n            __extends(ReactMapboxGl, _super);\n            function ReactMapboxGl() {\n                var _this = _super !== null && _super.apply(this, arguments) || this;\n                _this.state = {\n                    map: undefined,\n                    ready: false\n                };\n                _this.listeners = {};\n                _this._isMounted = true;\n                _this.calcCenter = function (bounds) { return [\n                    (bounds[0][0] + bounds[1][0]) / 2,\n                    (bounds[0][1] + bounds[1][1]) / 2\n                ]; };\n                _this.setRef = function (x) {\n                    _this.container = x;\n                };\n                return _this;\n            }\n            ReactMapboxGl.prototype.componentDidMount = function () {\n                var _this = this;\n                var _a = this.props, style = _a.style, onStyleLoad = _a.onStyleLoad, center = _a.center, pitch = _a.pitch, zoom = _a.zoom, fitBounds = _a.fitBounds, fitBoundsOptions = _a.fitBoundsOptions, bearing = _a.bearing, maxBounds = _a.maxBounds;\n                MapboxGl.accessToken = accessToken;\n                if (apiUrl) {\n                    MapboxGl.config.API_URL = apiUrl;\n                }\n                if (!Array.isArray(zoom)) {\n                    throw new Error('zoom need to be an array type of length 1 for reliable update');\n                }\n                var opts = {\n                    preserveDrawingBuffer: preserveDrawingBuffer,\n                    hash: hash,\n                    zoom: zoom[0],\n                    minZoom: minZoom,\n                    maxZoom: maxZoom,\n                    maxBounds: maxBounds,\n                    container: this.container,\n                    center: fitBounds && center === defaultCenter\n                        ? this.calcCenter(fitBounds)\n                        : center,\n                    style: style,\n                    scrollZoom: scrollZoom,\n                    attributionControl: attributionControl,\n                    customAttribution: customAttribution,\n                    interactive: interactive,\n                    dragRotate: dragRotate,\n                    pitchWithRotate: pitchWithRotate,\n                    renderWorldCopies: renderWorldCopies,\n                    trackResize: trackResize,\n                    touchZoomRotate: touchZoomRotate,\n                    doubleClickZoom: doubleClickZoom,\n                    keyboard: keyboard,\n                    dragPan: dragPan,\n                    boxZoom: boxZoom,\n                    refreshExpiredTiles: refreshExpiredTiles,\n                    logoPosition: logoPosition,\n                    bearingSnap: bearingSnap,\n                    failIfMajorPerformanceCaveat: failIfMajorPerformanceCaveat,\n                    antialias: antialias,\n                    transformRequest: transformRequest\n                };\n                if (bearing) {\n                    if (!Array.isArray(bearing)) {\n                        throw new Error('bearing need to be an array type of length 1 for reliable update');\n                    }\n                    opts.bearing = bearing[0];\n                }\n                if (pitch) {\n                    if (!Array.isArray(pitch)) {\n                        throw new Error('pitch need to be an array type of length 1 for reliable update');\n                    }\n                    opts.pitch = pitch[0];\n                }\n                var map = new MapboxGl.Map(opts);\n                this.setState({ map: map });\n                if (fitBounds) {\n                    map.fitBounds(fitBounds, fitBoundsOptions, { fitboundUpdate: true });\n                }\n                map.on('load', function (evt) {\n                    if (_this._isMounted) {\n                        _this.setState({ ready: true });\n                    }\n                    if (onStyleLoad) {\n                        onStyleLoad(map, evt);\n                    }\n                });\n                this.listeners = listenEvents(events, this.props, map);\n            };\n            ReactMapboxGl.prototype.componentWillUnmount = function () {\n                var map = this.state.map;\n                this._isMounted = false;\n                if (map) {\n                    map.remove();\n                }\n            };\n            ReactMapboxGl.prototype.UNSAFE_componentWillReceiveProps = function (nextProps) {\n                var map = this.state.map;\n                if (!map) {\n                    return null;\n                }\n                this.listeners = updateEvents(this.listeners, nextProps, map);\n                var center = map.getCenter();\n                var zoom = map.getZoom();\n                var bearing = map.getBearing();\n                var pitch = map.getPitch();\n                var didZoomUpdate = this.props.zoom !== nextProps.zoom &&\n                    (nextProps.zoom && nextProps.zoom[0]) !== zoom;\n                var didCenterUpdate = this.props.center !== nextProps.center &&\n                    ((nextProps.center && nextProps.center[0]) !== center.lng ||\n                        (nextProps.center && nextProps.center[1]) !== center.lat);\n                var didBearingUpdate = this.props.bearing !== nextProps.bearing &&\n                    (nextProps.bearing && nextProps.bearing[0]) !== bearing;\n                var didPitchUpdate = this.props.pitch !== nextProps.pitch &&\n                    (nextProps.pitch && nextProps.pitch[0]) !== pitch;\n                if (nextProps.maxBounds) {\n                    var didMaxBoundsUpdate = this.props.maxBounds !== nextProps.maxBounds;\n                    if (didMaxBoundsUpdate) {\n                        map.setMaxBounds(nextProps.maxBounds);\n                    }\n                }\n                if (nextProps.fitBounds) {\n                    var fitBounds = this.props.fitBounds;\n                    var didFitBoundsUpdate = fitBounds !== nextProps.fitBounds ||\n                        nextProps.fitBounds.length !== (fitBounds && fitBounds.length) ||\n                        !!fitBounds.filter(function (c, i) {\n                            var nc = nextProps.fitBounds && nextProps.fitBounds[i];\n                            return c[0] !== (nc && nc[0]) || c[1] !== (nc && nc[1]);\n                        })[0];\n                    if (didFitBoundsUpdate ||\n                        !isEqual(this.props.fitBoundsOptions, nextProps.fitBoundsOptions)) {\n                        map.fitBounds(nextProps.fitBounds, nextProps.fitBoundsOptions, {\n                            fitboundUpdate: true\n                        });\n                    }\n                }\n                if (didZoomUpdate ||\n                    didCenterUpdate ||\n                    didBearingUpdate ||\n                    didPitchUpdate) {\n                    var mm = nextProps.movingMethod || defaultMovingMethod;\n                    var flyToOptions = nextProps.flyToOptions, animationOptions = nextProps.animationOptions;\n                    map[mm](__assign({}, animationOptions, flyToOptions, { zoom: didZoomUpdate && nextProps.zoom ? nextProps.zoom[0] : zoom, center: didCenterUpdate ? nextProps.center : center, bearing: didBearingUpdate ? nextProps.bearing : bearing, pitch: didPitchUpdate ? nextProps.pitch : pitch }));\n                }\n                if (!isEqual(this.props.style, nextProps.style)) {\n                    map.setStyle(nextProps.style);\n                }\n                return null;\n            };\n            ReactMapboxGl.prototype.render = function () {\n                var _a = this.props, containerStyle = _a.containerStyle, className = _a.className, children = _a.children, renderChildrenInPortal = _a.renderChildrenInPortal;\n                var _b = this.state, ready = _b.ready, map = _b.map;\n                if (renderChildrenInPortal) {\n                    var container = ready && map && typeof map.getCanvasContainer === 'function'\n                        ? map.getCanvasContainer()\n                        : undefined;\n                    return (React.createElement(MapContext.Provider, { value: map },\n                        React.createElement(\"div\", { ref: this.setRef, className: className, style: __assign({}, containerStyle) }, ready && container && createPortal(children, container))));\n                }\n                return (React.createElement(MapContext.Provider, { value: map },\n                    React.createElement(\"div\", { ref: this.setRef, className: className, style: __assign({}, containerStyle) }, ready && children)));\n            };\n            return ReactMapboxGl;\n        }(React.Component)),\n        _z.defaultProps = {\n            onStyleLoad: function (map, evt) { return null; },\n            center: defaultCenter,\n            zoom: defaultZoom,\n            bearing: 0,\n            movingMethod: defaultMovingMethod,\n            pitch: 0,\n            containerStyle: {\n                textAlign: 'left'\n            }\n        },\n        _z;\n};\nexport default ReactMapboxFactory;\n//# sourceMappingURL=map.js.map"]},"metadata":{},"sourceType":"module"}